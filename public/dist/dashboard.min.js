angular.module("appDashboard",["ngResource","ui.router","ui.bootstrap"]),angular.module("appDashboard").run(["$rootScope","$timeout","$interval",function(o){o.servant={}}]),angular.module("appDashboard").config(["$stateProvider","$urlRouterProvider",function(o,n){n.otherwise("/"),o.state("dashboard",{url:"/",templateUrl:"views/dashboard/dashboard.html"})}]),angular.module("appDashboard").config(["$locationProvider",function(o){o.hashPrefix("!")}]);var environment=$("#dashboard-container").attr("data-dashboard");"development"===environment&&console.log("Environment: Development"),angular.module("appDashboard").controller("DashboardController",["$rootScope","$scope","$timeout","$modal","LeadCapture",function(o,n,i,e,a){n.domains=[],n.new_domain,n.new_popup,n.new_option,n.new_event="timer",n.field_types=["email","full_name","select"],n.field="email",n.fields={},n.fields.email={type:"email"},n.fields.full_name={type:"full_name"},n.fields.select={type:"select",title:"Untitled Select Field",options:["Option one","Option two"]};var d={title:"Untitled Pop-Up",cta1:"Get Updates",cta2:"Sign up to receive updates about our service",blocks:[n.fields.full_name,n.fields.email],events:[{type:"timer",time:2e3}]};n.initialize=function(){n.popup_index=0,n.domain_index=0,n.listDomains(),n.$watch("domain_index",function(o,i){o!==i&&(n.popup_index=0)})},n.listDomains=function(o){a.listDomains(function(i){console.log("Domains Fetched: ",i),n.domains=i,o&&o()},function(o){console.log(o)})},n.setDomain=function(o){n.domain_index=o},n.createDomain=function(){a.createDomain({},{domain:n.new_domain},function(){n.listDomains(function(){n.new_domain=""})},function(o){console.log(o)})},n.destroyDomain=function(o,i){a.destroyDomain({domain:o.domain},function(){n.domains.splice(i,1)},function(o){console.log(o)})},n.createPopup=function(){if(n.new_popup&&n.new_popup.length){if(n.domains[n.domain_index].popups&&n.domains[n.domain_index].popups.length>=4)return alert("You have the maximum amount of popups allowed for a domain"),void 0;var o=angular.copy(d);o.title=n.new_popup,n.domains[n.domain_index].popups||(n.domains[n.domain_index].popups=[]),n.domains[n.domain_index].popups.push(o),n.new_popup="",n.popup_index=n.domains[n.domain_index].popups.length-1}},n.setPopup=function(o){n.popup_index=o},n.removePopup=function(o){var i=confirm("Are you sure you want to delete this Pop-Up?");i&&n.domains[n.domain_index].popups.splice(o,1),n.popup_index=n.domains[n.domain_index].popups.length-1},n.saveAndPreview=function(){a.saveDomain(null,n.domains[n.domain_index],function(o){n.domains[n.domain_index]=o,window.location="/preview/"+o.domain},function(o){console.log(o)})},n.addField=function(){n.domains[n.domain_index].popups[n.popup_index].blocks.push(n.fields[n.field]),n.field="email",console.log("Field Added: ",n.domains[n.domain_index])},n.addOption=function(o){n.domains[n.domain_index].popups[n.popup_index].blocks[o].options.push(n.new_option),n.new_option=""},n.addEvent=function(){n.events=[{type:"timer",time:2e3}]},n.moveBlock=function(o,i,e){"up"===e&&i>0&&(n.domains[n.domain_index].popups[n.popup_index].blocks.splice(i,1),n.domains[n.domain_index].popups[n.popup_index].blocks.splice(i-1,0,o)),"down"===e&&i<n.domains[n.domain_index].popups[n.popup_index].blocks.length&&(n.domains[n.domain_index].popups[n.popup_index].blocks.splice(i,1),n.domains[n.domain_index].popups[n.popup_index].blocks.splice(i+1,0,o))}}]),angular.module("appDashboard").factory("LeadCapture",["$resource",function(o){return o("",null,{listDomains:{method:"GET",isArray:!0,url:"/domains"},createDomain:{method:"POST",isArray:!1,url:"/domains"},saveDomain:{method:"PUT",isArray:!1,url:"/domains/:domain"},destroyDomain:{method:"DELETE",isArray:!1,url:"/domains/:domain"}})}]);