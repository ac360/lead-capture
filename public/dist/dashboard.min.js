angular.module("appDashboard",["ngResource","ui.router","ui.bootstrap"]),angular.module("appDashboard").run(["$rootScope","$timeout","$interval",function(o){o.servant={}}]),angular.module("appDashboard").config(["$stateProvider","$urlRouterProvider",function(o,n){n.otherwise("/"),o.state("dashboard",{url:"/",templateUrl:"views/dashboard/dashboard.html"})}]),angular.module("appDashboard").config(["$locationProvider",function(o){o.hashPrefix("!")}]);var environment=$("#dashboard-container").attr("data-dashboard");"development"===environment&&console.log("Environment: Development"),angular.module("appDashboard").controller("DashboardController",["$rootScope","$scope","$timeout","$modal","LeadCapture",function(o,n,i,e,a){n.domains=[],n.new_domain,n.new_option,n.field_types=["email","full_name","select"],n.field="email",n.fields={},n.fields.email={type:"email"},n.fields.full_name={type:"full_name"},n.fields.select={type:"select",title:"Untitled Select Field",options:["Option one","Option two"]},n.events=["email","full_name","select"];var d={title:"Untitled Form",cta1:"Get Updates",cta2:"Sign up to receive updates about our service",blocks:[n.fields.full_name,n.fields.email]};n.initialize=function(){n.form_index=0,n.domain_index=0,n.listDomains(function(){n.domains[n.domain_index].forms[0]||(n.domains[n.domain_index].forms[n.form_index]=angular.copy(d))}),n.$watch("domain_index",function(o,i){o!==i&&(console.log("Changed Domain"),n.form_index=0,n.domains[n.domain_index].forms[0]||(n.domains[n.domain_index].forms[n.form_index]=angular.copy(d)))})},n.listDomains=function(o){a.listDomains(function(i){console.log("Domains Fetched: ",i),n.domains=i,o&&o()},function(o){console.log(o)})},n.createDomain=function(){a.createDomain({},{domain:n.new_domain},function(){n.listDomains(function(){n.new_domain="",n.domains[n.domain_index].forms[0]||(n.domains[n.domain_index].forms[n.form_index]=angular.copy(d))})},function(o){console.log(o)})},n.saveAndPreview=function(){a.saveDomain(null,n.domains[n.domain_index],function(o){n.domains[n.domain_index]=o,window.location="/preview/"+o.domain},function(o){console.log(o)})},n.addField=function(){n.domains[n.domain_index].forms[n.form_index].blocks.push(n.fields[n.field]),n.field="email",console.log("Field Added: ",n.domains[n.domain_index])},n.addOption=function(o){console.log(n.new_option),n.domains[n.domain_index].forms[n.form_index].blocks[o].options.push(n.new_option),n.new_option=""},n.moveBlock=function(o,i,e){"up"===e&&i>0&&(n.domains[n.domain_index].forms[n.form_index].blocks.splice(i,1),n.domains[n.domain_index].forms[n.form_index].blocks.splice(i-1,0,o)),"down"===e&&i<n.form.blocks.length&&(n.domains[n.domain_index].forms[n.form_index].blocks.splice(i,1),n.domains[n.domain_index].forms[n.form_index].blocks.splice(i+1,0,o))}}]),angular.module("appDashboard").factory("LeadCapture",["$resource",function(o){return o("",null,{listDomains:{method:"GET",isArray:!0,url:"/domains"},createDomain:{method:"POST",isArray:!1,url:"/domains"},saveDomain:{method:"PUT",isArray:!1,url:"/domains/:domain"}})}]);